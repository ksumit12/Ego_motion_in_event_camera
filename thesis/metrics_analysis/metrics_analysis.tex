\chapter{Sensitivity Analysis of Parameters}
\label{chap:metrics}

This chapter evaluates how key parameters in the prediction–cancellation pipeline influence performance and robustness. 
The objective is to quantify how sensitive the cancellation rate and residual density are to the choice of temporal horizon, spatial and temporal tolerances, polarity handling, and motion-model accuracy.
Unless stated otherwise, all experiments are conducted using events from the spinning-disc dataset described in Chapter~\ref{chap:experiment}, with the estimated center \((c_x, c_y)\) and angular velocity~\(\omega\) obtained from tracker data.

Each analysis follows the same general procedure: predicted events are generated using the per-event forward model
\[
\hat{e}_i = \big(x'_i,\, y'_i,\, t_i + \Delta t,\, -p_i \big),
\]
and compared against real events within a spatial tolerance~\(\epsilon_{xy}\) and temporal gate~\(\epsilon_t\). 
Cancellation is computed as
\[
\text{CR}(\Delta t) = \frac{N_{\text{cancelled}}}{N_{\text{real}}} \times 100\%.
\]
The following subsections examine the effect of varying each parameter individually.

% ------------------------------------------------------------
\section{Effect of Prediction Horizon \(\Delta t\)}
\label{sec:dt_sensitivity}

Figure~\ref{fig:dt_sweep} shows the measured cancellation rate as a function of prediction horizon \(\Delta t\) for three representative windows of the spinning-disc sequence. 
For small horizons (below 2–3~ms), cancellation exceeds 90\%, indicating nearly perfect temporal alignment between predicted and real events.
As \(\Delta t\) increases, phase drift accumulates between predicted trajectories and true motion, reducing overlap.

This decay follows an approximately exponential trend:
\[
\text{CR}(\Delta t) \approx \exp\!\left(-k_{\omega}\Delta t\right),
\]
where \(k_{\omega}\) depends on the angular velocity~\(\omega\) and uncertainty in the estimated center.
At large \(\Delta t\), residuals approach a baseline level (≈30–35\%), corresponding to non-overlapping edge regions and noise events.

The smoothness of this curve (as seen in Fig.~\ref{fig:dt_sweep_combined}) demonstrates temporal consistency across windows, confirming that the current motion model captures the dominant rotational component.
Earlier versions using coarse time binning showed step-like discontinuities in this curve due to quantization artifacts; replacing bins with a continuous temporal gate (\S\ref{sec:temporal_gate}) yielded the present monotonic decay.

From a physical perspective, \(\Delta t\) governs the \textit{phase misalignment} between predicted and observed events.
For a rotating edge with angular velocity~\(\omega\), the phase error grows linearly with~\(\Delta t\):
\[
\Delta \theta = \omega \, \Delta t,
\]
which directly converts into a spatial displacement \(r\,\Delta\theta\) on the image plane.
When this displacement exceeds the spatial tolerance~\(\epsilon_{xy}\), predicted and real events fail to cancel.
Hence, the intersection between temporal and spatial tolerances defines the operational limit of effective cancellation.

% ------------------------------------------------------------
\section{Spatial Tolerance (\( \epsilon_{xy} \), pixels)}
\label{sec:spatial_tolerance}

Spatial tolerance specifies the search radius in pixels used to match a predicted event with a real event.
A small~\(\epsilon_{xy}\) increases precision but risks missing true matches; a large~\(\epsilon_{xy}\) recovers more pairs but admits false positives, especially in textured regions or where polarity is ignored.

Figure~\ref{fig:spatial_tolerance} illustrates this trade-off.
The cancellation rate initially rises rapidly with \(\epsilon_{xy}\) up to about 2–3 pixels, after which gains saturate while the residual density begins to increase.
This saturation indicates the true geometric uncertainty of the motion model, dominated by small calibration errors in center estimation (\(\sigma_c\)) and discretization in the image grid.

Empirically, the optimal value lies in the range
\[
\epsilon_{xy}^{*} \approx r\,|\Delta\omega|\,\Delta t + \sigma_c,
\]
where \(\Delta\omega\) denotes angular-velocity error.
This relation, derived from the geometric expansion of motion error, highlights that the required tolerance grows linearly with prediction horizon and model uncertainty.

In practical implementations,~\(\epsilon_{xy}\in[2,3]\) pixels yielded the best compromise between cancellation completeness and background leakage.
Larger radii (≥5 px) inflated the apparent performance but led to spurious cancellation across edges or static regions, reducing interpretability.

% ------------------------------------------------------------
\section{Temporal Tolerance (\( \epsilon_{t} \), ms)}
\label{sec:temporal_tolerance}

Temporal tolerance controls the allowed timestamp deviation between a predicted event’s nominal time~\(t+\Delta t\) and the real event timestamp~\(t_j\).
This parameter is crucial in asynchronous data association, especially given event timing jitter and sensor timestamp quantization (\( \approx 1\text{--}10~\mu\text{s} \)).

Sweeping~\(\epsilon_t\) from 0.1 to 1.0~ms shows a near-linear improvement in cancellation until around 0.5~ms, beyond which additional relaxation brings diminishing returns.
When~\(\epsilon_t\) is too small, genuine matches are missed due to timestamp jitter or the latency of the predictive model.
When too large, temporal overlap with unrelated events causes false cancellations, especially in regions of dense texture or high rotation speed.

The optimal tolerance can be approximated analytically as:
\[
\epsilon_t^{*} \approx \frac{\epsilon_{xy}}{r\,|\omega|},
\]
ensuring that the predicted phase deviation translates to less than one spatial pixel of drift.
This formulation links the temporal and spatial gates, and aligns with motion-compensation theory in Gallego et~al.~\cite{Gallego2018CMax, Xu2020}.

The shift from fixed time binning to explicit gating was key to achieving the smooth trends seen in Figure~\ref{fig:dt_sweep}.
Binning previously introduced discontinuous transitions when events crossed bin edges, whereas the continuous gate now provides symmetric tolerance around each predicted timestamp.

% ------------------------------------------------------------
\section{Polarity Handling}
\label{sec:polarity}

Polarity reflects whether a pixel’s intensity increased or decreased (\(+1\) or \(-1\)).
In the predictive cancellation model, polarity can be leveraged in two ways:
(1) to enforce strict cancellation between opposite polarities, or 
(2) to ignore polarity and rely solely on spatial–temporal overlap.

Figure~\ref{fig:polarity} compares these modes.
When polarity is enforced, cancellation ratios drop slightly (≈5–10\%) but residual maps become visually cleaner, showing sharper edge boundaries.
When polarity is ignored, cancellation increases numerically but residuals contain symmetric artifacts (i.e., both ON and OFF edges remain faintly visible).

This asymmetry arises from edge directionality:
rotational motion produces alternating polarities along opposite edges of the disk.
By enforcing opposite-polarity cancellation (\(p_{\text{pred}} = -p_{\text{real}}\)), the model suppresses self-cancellation of homogeneous regions and better represents predictive inhibition as discussed by Hosoya et~al.~\cite{Hosoya2005Dynamic} and Rao \& Ballard~\cite{Rao1999Predictive}.

Hence, for biologically inspired cancellation, polarity should be treated as an inhibitory sign rather than ignored.

% ------------------------------------------------------------
\section{Angular Velocity Bias}
\label{sec:omega_bias}

To assess robustness to motion-model error, a constant bias term~\(\delta\omega\) was added to the estimated angular velocity:
\[
\omega' = \omega + \delta\omega.
\]
For each bias level, predicted events were regenerated and cancellation recalculated.

Results show a quasi-linear sensitivity within a small range (|\(\delta\omega\)| < 0.05~rad/ms), beyond which performance collapses rapidly.
This behaviour aligns with the phase-drift relation:
\[
\Delta\theta_{\text{err}} = \delta\omega\,\Delta t.
\]
Even a small bias accumulates over time, producing circular misalignment that the spatial gate cannot recover.
The slope of the initial decline in CR(\(\delta\omega\)) defines the effective linear range of model validity.

These experiments also reveal that underestimation of~\(\omega\) causes residual events to cluster ahead of the predicted contour, while overestimation shifts them backward.
Visual inspection of high-pass residuals confirms this symmetry, providing an intuitive diagnostic for tuning~\(\omega\).

% ------------------------------------------------------------
\section{Residuals vs. Background Baseline}
\label{sec:residuals_baseline}

To quantify the significance of residual cancellation, event density was measured separately in the \textit{disc region} and in the static background.
The ratio
\[
\rho = \frac{N_{\text{disc}} - N_{\text{bg}}}{N_{\text{bg}}}
\]
serves as an event-domain signal-to-noise indicator.
After cancellation, this ratio typically decreased from ≈5.0 to ≈1.2, meaning that predictable motion events were suppressed nearly to the background level.

Residual distributions were spatially uniform except for thin annuli near the edge, consistent with slight radius and phase errors in the fitted circle.
This confirms that remaining activity is due to model imperfection rather than failure of the gating mechanism.

Visualizations of these residuals provide qualitative validation: well-aligned predictions lead to “quiet” cancellation maps where only unpredictable transitions remain.
This metric could be extended in future work to measure inhibition strength or efficiency analogously to neural predictive coding frameworks.

% ------------------------------------------------------------
\section{Summary of Trends}
\label{sec:summary_trends}

The following trends summarize the observed sensitivities:

\begin{itemize}
    \item \textbf{Prediction horizon \(\Delta t\):} Cancellation decreases exponentially with horizon; effective range up to 6–8~ms for the given rotational speed.
    \item \textbf{Spatial tolerance \(\epsilon_{xy}\):} Optimal around 2–3~px; larger values inflate false matches.
    \item \textbf{Temporal tolerance \(\epsilon_t\):} Optimal ≈0.5~ms; balances timestamp jitter and event density.
    \item \textbf{Polarity:} Enforcing opposite polarity yields cleaner inhibition maps, though slightly lower numeric CR.
    \item \textbf{Angular velocity bias:} Linear degradation up to ±0.05~rad/ms, beyond which phase errors dominate.
    \item \textbf{Residual density:} Post-cancellation event density approaches background level, confirming effective suppression of predictable motion.
\end{itemize}

Overall, these analyses establish quantitative operating bounds for the proposed predictive cancellation model. 
They also highlight which parameters are most critical for tuning and which are robust to small deviations, informing both algorithmic refinement and potential real-time hardware implementation.

